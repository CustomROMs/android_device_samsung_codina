From b32c41aee145322989fce7881d6663361b074d5b Mon Sep 17 00:00:00 2001
From: Shilin Victor <radicaldreamer00001@gmail.com>
Date: Fri, 29 Mar 2019 22:55:20 +0300
Subject: [PATCH 15/20] system-core_WW004-when-waiting-child-process.patch

Change-Id: I1ecb704416cbb5005cebfb71e97e15c97acacc78
---
 logwrapper/logwrap.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/logwrapper/logwrap.c b/logwrapper/logwrap.c
index 44455d157..88197b07c 100644
--- a/logwrapper/logwrap.c
+++ b/logwrapper/logwrap.c
@@ -400,7 +400,7 @@ static int parent(const char *tag, int parent_read, pid_t pid,
         if (poll_fds[0].revents & POLLHUP) {
             int ret;
 
-            ret = waitpid(pid, &status, WNOHANG);
+            ret = TEMP_FAILURE_RETRY(waitpid(pid, &status, 0));
             if (ret < 0) {
                 rc = errno;
                 ALOG(LOG_ERROR, "logwrap", "waitpid failed with %s\n", strerror(errno));
-- 
2.11.0

