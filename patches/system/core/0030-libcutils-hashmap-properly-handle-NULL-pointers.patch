From 5a47385bcd5851f2756d5abc9cee7c1dd67d7438 Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Sun, 30 Sep 2018 05:46:30 +0300
Subject: [PATCH 30/30] libcutils: hashmap: properly handle NULL pointers

Change-Id: I8bf33ecd543e601a318c3eb8a0825b30d74f4b95
---
 libcutils/hashmap.cpp | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/libcutils/hashmap.cpp b/libcutils/hashmap.cpp
index 65b6ab185..47ebaf2cd 100644
--- a/libcutils/hashmap.cpp
+++ b/libcutils/hashmap.cpp
@@ -18,6 +18,7 @@
 
 #include <assert.h>
 #include <errno.h>
+#include <cutils/log.h>
 #include <cutils/threads.h>
 #include <stdlib.h>
 #include <string.h>
@@ -227,6 +228,16 @@ void* hashmapPut(Hashmap* map, void* key, void* value) {
 }
 
 void* hashmapGet(Hashmap* map, void* key) {
+    if (map == NULL) {
+        ALOGE("%s: map == NULL!", __func__);
+        return NULL;
+    }
+
+    if (key == NULL) {
+        ALOGE("%s: key == NULL!", __func__);
+        return NULL;
+    }
+
     int hash = hashKey(map, key);
     size_t index = calculateIndex(map->bucketCount, hash);
 
-- 
2.11.0

