From 185b45256d3291edb28ed1a4d76e7611c76bce83 Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Mon, 27 Aug 2018 05:01:00 +0300
Subject: [PATCH 16/31] libsuspend: fix build

Change-Id: I985151b05bf1c08d6d04fc6f51fb5063942601fa
---
 libsuspend/autosuspend_wakeup_count.c   | 2 +-
 libsuspend/autosuspend_wakeup_count.cpp | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/libsuspend/autosuspend_wakeup_count.c b/libsuspend/autosuspend_wakeup_count.c
index 2da204ae0..e2e48ee3b 100644
--- a/libsuspend/autosuspend_wakeup_count.c
+++ b/libsuspend/autosuspend_wakeup_count.c
@@ -155,7 +155,7 @@ static int autosuspend_wakeup_count_disable(void)
     return ret;
 }
 
-void set_wakeup_callback(void (*func)(bool success))
+void autosuspend_set_wakeup_callback(void (*func)(bool success))
 {
     if (wakeup_func != NULL) {
         ALOGE("Duplicate wakeup callback applied, keeping original");
diff --git a/libsuspend/autosuspend_wakeup_count.cpp b/libsuspend/autosuspend_wakeup_count.cpp
index 27c862957..03be44d04 100644
--- a/libsuspend/autosuspend_wakeup_count.cpp
+++ b/libsuspend/autosuspend_wakeup_count.cpp
@@ -216,7 +216,7 @@ static int force_suspend(int timeout_ms) {
     return WriteStringToFd(sleep_state, state_fd) ? 0 : -1;
 }
 
-static void autosuspend_set_wakeup_callback(void (*func)(bool success)) {
+extern "C" void autosuspend_set_wakeup_callback(void (*func)(bool success)) {
     if (wakeup_func != NULL) {
         LOG(ERROR) << "duplicate wakeup callback applied, keeping original";
         return;
-- 
2.11.0

