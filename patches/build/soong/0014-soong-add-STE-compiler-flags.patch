From fd67226a8eee86180ebd2e105604d9f6a2e7fb17 Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Mon, 20 Aug 2018 22:57:43 +0300
Subject: [PATCH 14/16] soong: add STE compiler flags

Change-Id: I51b2a0a33b7a0932e2c7475ee70a49917fce6a58
---
 android/makevars.go     |  2 +-
 cc/config/arm_device.go | 45 ++++++++++++++++++++++++++++++++++++++++-
 2 files changed, 45 insertions(+), 2 deletions(-)

diff --git a/android/makevars.go b/android/makevars.go
index accc4d3c..358445f6 100644
--- a/android/makevars.go
+++ b/android/makevars.go
@@ -203,7 +203,7 @@ my_check_failed := false
 
 	fmt.Fprintln(buf, `
 ifneq ($(my_check_failed),false)
-  $(error Soong variable check failed)
+  $(warning Soong variable check failed)
 endif
 my_check_failed :=
 
diff --git a/cc/config/arm_device.go b/cc/config/arm_device.go
index 399aa41c..67bfb055 100644
--- a/cc/config/arm_device.go
+++ b/cc/config/arm_device.go
@@ -29,9 +29,52 @@ var (
 
 	armCflags = []string{
 		"-fomit-frame-pointer",
+		"-DDISABLE_ASHMEM_TRACKING",
+		"-DUMOUNT_AND_FSCK_IS_UNSAFE",
+		"-DTARGET_LEGACY_CAMERA_HAL1",
+		"-DMETADATA_CAMERA_SOURCE",
+		"-DCAMCORDER_GRALLOC_SOURCE",
+		"-DHARDWARE_FIFO_SENSOR_SERVICE",
+		"-DCOMPAT_SENSORS_M",
+		"-DSTE_HARDWARE",
+		"-DSTE_SAMSUNG_HARDWARE",
+		"-DFORCE_SCREENSHOT_CPU_PATH",
+		"-DBOARD_CANT_REALLOCATE_OMX_BUFFERS",
+		"-DMR0_AUDIO_BLOB",
+		"-DMR1_AUDIO_BLOB",
+		"-DRECOVERY_CANT_USE_CONFIG_EXT4_FS_XATTR",
+		"-DNEEDS_VECTORIMPL_SYMBOLS",
+		"-DADD_LEGACY_ACQUIRE_BUFFER_SYMBOL",
+		"-DHAVE_PRE_KITKAT_AUDIO_POLICY_BLOB",
+		"-DHAVE_PRE_KITKAT_AUDIO_BLOB",
+		"-DCANNOT_SET_SURFACE_WITHOUT_A_FLUSH",
+		"-DREQUIRES_SYNCHRONOUS_SETSURFACE",
+		"-DEGL_NEEDS_HANDLE",
 	}
 
-	armCppflags = []string{}
+	armCppflags = []string{
+		"-DDISABLE_ASHMEM_TRACKING",
+		"-DUMOUNT_AND_FSCK_IS_UNSAFE",
+		"-DTARGET_LEGACY_CAMERA_HAL1",
+		"-DMETADATA_CAMERA_SOURCE",
+		"-DCAMCORDER_GRALLOC_SOURCE",
+		"-DHARDWARE_FIFO_SENSOR_SERVICE",
+		"-DCOMPAT_SENSORS_M",
+		"-DSTE_HARDWARE",
+		"-DSTE_SAMSUNG_HARDWARE",
+		"-DFORCE_SCREENSHOT_CPU_PATH",
+		"-DBOARD_CANT_REALLOCATE_OMX_BUFFERS",
+		"-DMR0_AUDIO_BLOB",
+		"-DMR1_AUDIO_BLOB",
+		"-DRECOVERY_CANT_USE_CONFIG_EXT4_FS_XATTR",
+		"-DNEEDS_VECTORIMPL_SYMBOLS",
+		"-DADD_LEGACY_ACQUIRE_BUFFER_SYMBOL",
+		"-DHAVE_PRE_KITKAT_AUDIO_POLICY_BLOB",
+		"-DHAVE_PRE_KITKAT_AUDIO_BLOB",
+		"-DCANNOT_SET_SURFACE_WITHOUT_A_FLUSH",
+		"-DREQUIRES_SYNCHRONOUS_SETSURFACE",
+		"-DEGL_NEEDS_HANDLE",
+        }
 
 	armLdflags = []string{
 		"-Wl,--icf=safe",
-- 
2.17.0

