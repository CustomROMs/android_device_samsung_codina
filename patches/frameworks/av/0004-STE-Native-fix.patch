From 560d102526bb916da5937cb03a1edae64a73d5f0 Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Mon, 3 Sep 2018 07:19:10 +0300
Subject: [PATCH 4/4] STE Native fix

Change-Id: I13ae08ae23fc57fd454c1f389b151d112789c34e
---
 media/ndk/NdkImageReader.cpp | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/media/ndk/NdkImageReader.cpp b/media/ndk/NdkImageReader.cpp
index e90783d0e..fe1761365 100644
--- a/media/ndk/NdkImageReader.cpp
+++ b/media/ndk/NdkImageReader.cpp
@@ -149,7 +149,9 @@ AImageReader::BufferRemovedListener::onBufferFreed(const wp<GraphicBuffer>& grap
     msg->setPointer(
         AImageReader::kCallbackFpKey, (void*) mListener.onBufferRemoved);
     msg->setPointer(AImageReader::kContextKey, mListener.context);
+#ifndef STE_HARDWARE
     msg->setObject(AImageReader::kGraphicBufferKey, gBuffer);
+#endif
     msg->post();
 }
 
-- 
2.17.0

