From 8b87e7b97800f8ecf613d3f27a1cf776c8a3f54e Mon Sep 17 00:00:00 2001
From: Shilin Victor <radicaldreamer00001@gmail.com>
Date: Fri, 29 Mar 2019 22:51:45 +0300
Subject: [PATCH 07/30] frameworks-native_W4-Fix-race-in-AppOpsManager.patch

Change-Id: I9dbe29e946598b9e8cd5ac727cc9c78fbb8a8300
---
 libs/binder/AppOpsManager.cpp | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/libs/binder/AppOpsManager.cpp b/libs/binder/AppOpsManager.cpp
index e4d82019f..f8626cb85 100644
--- a/libs/binder/AppOpsManager.cpp
+++ b/libs/binder/AppOpsManager.cpp
@@ -53,7 +53,8 @@ sp<IAppOpsService> AppOpsManager::getService()
                 ALOGI("Waiting for app ops service");
             } else if ((uptimeMillis()-startTime) > 10000) {
                 ALOGW("Waiting too long for app ops service, giving up");
-                return NULL;
+                service = NULL;
+                break;
             }
             sleep(1);
         } else {
-- 
2.11.0

